<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8" />
		<title></title>
		<meta name="viewport" content="initial-scale=1,maximum-scale=1" />
		<link href="css/base.css" rel="stylesheet" />
		<link href="css/common.css" rel="stylesheet" />
		<link href="font/iconfont.css" rel="stylesheet" />
		<link href="layui/css/layui.css" rel="stylesheet" />
		<style>
			.avatar {
				height: 50px;
				line-height: 50px;
				background: #eee;
				border-bottom: 1px solid #d2d2d2;
			}
			
			.avatar video {
				width: 30px;
				height: 30px;
				border-radius: 50%;
				vertical-align: middle;
				margin-right: 5px;
			}
			
			.voteMsg {
				background: #eee;
				border-bottom: 1px solid #d2d2d2;
			}
			
			.voteMsg li {
				float: left;
				width: 50%;
				box-sizing: border-box;
				border-right: 1px solid #d2d2d2;
			}
			
			.voteMsg li:last-child {
				border-right: none;
			}
			
			.voteMsg i {
				margin: 0 5px;
			}
			
			.signBtn {
				background: #ff4238;
				display: block;
				width: 95%;
				margin: 0 auto 20px auto;
				height: 40px;
				line-height: 40px;
				text-decoration: none;
				color: #fff;
				border-radius: 5px;
			}
		</style>
	</head>

	<body>
		<div id="app">
			<div class="main_wrap" style="margin-bottom:59px">
				<div class="tc avatar">{{ playerObj.name }}</div>
				<ul class="voteMsg tc pt10 pb10 oh">
					<li>
						<p><i class="icon iconfont icon-touxiang"></i>编号</p>
						<p>{{ playerObj.no.substr(8, 4) }}</p>
					</li>
					<li @click="goUrl('votes.html?phone='+phone+'&isapp='+isapp+'&voteid='+playerObj.id)">
						<p><i class="icon iconfont icon-dianzan"></i>票数</p>
						<p>{{ playerObj.votes }}</p>
					</li>
				</ul>
				<div class="mb10">
					<p class="mb10 tc mt10 tl pl5 pr5">
						<i class="icon iconfont icon-laba mr5"></i>{{ playerObj.remark }}
					</p>
					<video id="video" height="300" class="response" poster="https://znbc.oss-cn-beijing.aliyuncs.com/hd/20190822/fef909758553e6ed33370d1cc969699.jpg" src="https://znbc.oss-cn-beijing.aliyuncs.com/v/086da35674d98a045c8bf0a0cd8f0592.mp4" controls>
						<source v-bind:src="playerObj.vediourl" type="video/mp4" />
						<source v-bind:src="playerObj.vediourl" type="video/ogg" /> 您的手机不支持视频播放
					</video>
					<div id="infoPic"></div>
				</div>
				<div class="l-captcha" data-site-key="5cf932bfe9280935625f76654aab59e5" data-width="100%" data-callback="getResponse"></div>
				<a v-on:click="voteFun" class="signBtn tc" style="margin-bottom:10px;background:#43cb41">投票</a>
				<a v-on:click="goUrl('sign.html?phone='+phone+'&isapp='+isapp)" class="signBtn tc">我也要参加</a>
				<!--<div>
          <p style="text-align:center;font-size:20px;margin-bottom:10px">
            下载支农宝app，抢金穗免费房源
          </p>
          <p style="text-align:center;margin-bottom:10px">
            <img height="440" width="300" src="https://m.sqzht.com/h5shop/activity/cgnicevideo/img/cns.jpg" />
          </p>
          <div>
            <p
              style="text-align:left;margin-left:30px;color:red;font-size:17px;margin-bottom:10px"
            >
              1.从首页轮播图点击进入“金穗大厦房子免费
            </p>
            <p
              style="text-align:left;margin-left:43px;color:red;font-size:17px;margin-bottom:10px"
            >
              送”活动页面。
            </p>
            <p
              style="text-align:left;margin-left:30px;color:red;font-size:17px;margin-bottom:10px"
            >
              2.点击右下角“活动说明”按照报名步骤参与活动。
            </p>
            <p
              style="text-align:left;margin-left:30px;color:red;font-size:17px;margin-bottom:10px"
            >
              3.长按二维码识别安装支农宝APP到你的手机。
            </p>
          </div>
        </div>-->
				<!--<p style="text-align:center">
          <img height="140" width="140" src="video/img30.jpg" alt="" />
        </p>
        <p style="text-align:center;margin-bottom:10px">
          <img
            width="350"
            src="https://znbc.oss-cn-beijing.aliyuncs.com/liulun/2018110215325873508.png"
          />
        </p>-->

				<p></p>
			</div>
			<ul class="footer tc">
				<li v-on:click="goUrl('home.html?phone='+phone+'&isapp='+isapp)">
					<i class="icon iconfont icon-shouye"></i>首页
				</li>
				<li v-on:click="goUrl('sign.html?phone='+phone+'&isapp='+isapp)">
					<i class="icon iconfont icon-xiugai"></i>报名
				</li>
				<li v-on:click="goUrl('rank.html?phone='+phone+'&isapp='+isapp)">
					<i class="icon iconfont icon-01"></i>榜单
				</li>
				<li v-on:click="goUrl('https://m.znbchina.com/h5shop/back/news/news_info_f.html?id=3190&isapp=0&uid=1200476')">
					<i class="icon iconfont icon-tishi"></i>活动说明
				</li>
			</ul>
		</div>
		<script src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
		<script src="js/jquery1.42.min.js"></script>
		<script src="layui/layui.js"></script>
		<script src="js/tools.js"></script>
		<script src="js/vue.min.js"></script>
		<script>
			var browser = {
				versions: (function() {
					var e = navigator.userAgent;
					navigator.appVersion;
					return {
						trident: -1 < e.indexOf("Trident"),
						presto: -1 < e.indexOf("Presto"),
						webKit: -1 < e.indexOf("AppleWebKit"),
						gecko: -1 < e.indexOf("Gecko") && -1 == e.indexOf("KHTML"),
						mobile: !!e.match(/AppleWebKit.*Mobile.*/),
						ios: !!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),
						android: -1 < e.indexOf("Android") || -1 < e.indexOf("Linux"),
						iPhone: -1 < e.indexOf("iPhone"),
						iPad: -1 < e.indexOf("iPad"),
						webApp: -1 == e.indexOf("Safari")
					};
				})(),
				language: (
					navigator.browserLanguage || navigator.language
				).toLowerCase()
			};

			function getContent() {
				return "我为金穗国贸代言，请您为我投上宝贵的一票！";
			}

			function getThum() {
				return app.playerObj.imgurl;
			}
			var openid = localStorage.getItem("openid");
			if(browser.versions.mobile) {
				var ua = navigator.userAgent.toLowerCase();
				if("micromessenger" == ua.match(/MicroMessenger/i)) {
					var code = getParm("code");
					(null != code && "" != code) ||
					("" != openid && null != openid && "undefined" != openid) ||
					$.ajax({
							type: "get",
							dataType: "json",
							data: {
								url: "https://m.znbchina.com/h5shop/activity/maotai/cgnicevideo/info.html?isapp=0&id=" +
									getParm("id")
							},
							url: "https://m.sqzht.com/znb/public/wechat/snsapi_base",
							success: function(res) {
								console.log(res);
								var obj = eval(res);
								window.location.href = obj.data.auth_url;
							}
						}),
						("" != openid && null != openid && "undefined" != openid) ||
						$.ajax({
							type: "get",
							dataType: "json",
							data: {
								code: code
							},
							url: "https://m.sqzht.com/znb/public/wechat/get_openid",
							success: function(res1) {
								var obj = eval(res1);
								localStorage.setItem("openid", obj.openid);
							}
						});
				}
			}
			layui.use("layer", function() {});
			var app = new Vue({
				el: "#app",
				data: {
					playerObj: {
						no: ""
					},
					phone: 0,
					isapp: 0
				},
				methods: {
					goUrl: function(e) {
						location.href = e;
					},
					voteFun: function() {
						console.log(222);
						var parm = jQuery.parseJSON(getItem("parm"));
						if(
							(console.log(localStorage.getItem("parm")),
								console.log(localStorage.getItem("openid")),
								null != parm && 1 == parm.isapp)
						) {
							if(null == parm.phone || 0 == parm.phone)
								return void layui.layer.confirm(
									"请先登录！", {
										btn: ["登录", "取消"]
									},
									function() {
										/android/i.test(navigator.userAgent) ?
											android.go2login() :
											/ipad|iphone|iPod|iOS|mac/i.test(
												navigator.userAgent
											) &&
											window.webkit.messageHandlers.call_ios.postMessage(
												null
											);
									},
									function() {
										layui.layer.closeAll();
									}
								);
						} else if(
							"" == localStorage.getItem("openid") ||
							null == localStorage.getItem("openid") ||
							"undefined" == localStorage.getItem("openid")
						) {
							var vid = document.getElementById("video");
							return(
								vid.pause(),
								$("#video").css("display", "none"),
								void openAppShopinfo()
							);
						}
						$.ajax({
							type: "post",
							dataType: "json",
							traditional: !0,
							url: "/znb/public/Vote/castVoteOnlyOne",
							data: {
								type: maotaiID,
								id: getParm("id"),
								username: getParm("phone"),
								openid: localStorage.getItem("openid"),
								resp: flag
							},
							success: function(result) {
								var obj = eval(result);
								"0" == obj.resultscode ?
									layui.layer.msg(obj.errorMessage, {
										offset: "t"
									}) :
									(layui.layer.msg("恭喜你，投票成功！", {
											offset: "t"
										}),
										(app.playerObj.votes = result.data.votes));
							}
						});

					}
				}
			});
			$(function() {
				(app.phone = getParm("phone")),
				(app.isapp = getParm("isapp")),
				$.ajax({
					type: "post",
					dataType: "json",
					traditional: !0,
					url: "/znb/public/Vote/getVoteById",
					data: {
						type: maotaiID,
						id: getParm("id")
					},
					success: function(result) {
						app.playerObj = eval(result).data.vote;
					}
				});
			});
			var flag = "";

			function getResponse(e) {
				flag = e;
			}
		</script>
		<!--    <script src="//captcha.luosimao.com/static/dist/api.js"></script>-->
	</body>

</html>